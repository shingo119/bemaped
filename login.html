<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/ress.css">
    <link rel="stylesheet" href="css/login.css">
    <title>ログイン画面</title>
</head>
<body>
    <div class="formWrap">
        <div class="login-content">
            <h1>bemaped</h1>
            <input placeholder="Username" type="text" />
            <input placeholder="Password" type="password" />

            <button class="btn">Log in</button>
            
            <h6 id="ohSocial">Or, social?</h6>
            <div id="social">
                <button class="tw btn" id="tw">Twitter</button>
                <button class="fb btn" id="fb">Facebook</button>
                <button class="google fb btn" id="google">Google+</button>
            </div>
        </div>
        <footer>
            
        </footer>
    </div>

    <!-- jQuery読み込みCDN -->
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- JQuery -->    

    <script type="module">
        //###############################################
        // 必要なJSを読み込み
        //###############################################
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.4.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, signInAnonymously } from "https://www.gstatic.com/firebasejs/9.4.1/firebase-auth.js";


        //###############################################
        // Your web app's Firebase configuration
        //###############################################
        const firebaseConfig = {
            apiKey: "AIzaSyA0eX9ZgNNl8xyphlBITklE8cw2KtLdreg",
            authDomain: "sample-412b8.firebaseapp.com",
            databaseURL: "https://sample-412b8-default-rtdb.firebaseio.com",
            projectId: "sample-412b8",
            storageBucket: "sample-412b8.appspot.com",
            messagingSenderId: "278552571035",
            appId: "1:278552571035:web:8517296195d194fb6b6a3e"
        };
        const app = initializeApp(firebaseConfig);


        //###############################################
        //GoogleAuth用
        //###############################################
        const provider = new GoogleAuthProvider();
        provider.addScope('https://www.googleapis.com/auth/contacts.readonly');
        const auth = getAuth();


        //###############################################
        //Login処理
        //###############################################
        $("#google").on("click", function () {
            // console.log(this)
            signInWithPopup(auth, provider).then((result) => {
                //Login後のページ遷移
                window.location.href = "index.html";
                console.log(result)

            }).catch((error) => {
                // Handle Errors here.
                const errorCode = error.code;
                const errorMessage = error.message;
                // The email of the user's account used.
                const email = error.email;
                // The AuthCredential type that was used.
                const credential = GoogleAuthProvider.credentialFromError(error);
                // ...
            });
        });

        // スライドトグルのjQuery
        $('#ohSocial').on('click', function () {
            $('#social').slideToggle()
        });

        signInAnonymously(auth)
            .then(() => {
                // Signed in..
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                // ...
            });
    </script>
    
</body>
</html>